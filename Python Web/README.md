# 课程表查询

该项目是一个基于 Flask 的网络应用，主要功能是帮助用户登录到他们的学校网站并获取他们的课程表。以下是代码的详细解释和运行方式。

## 功能

1. 用户登录(单独接口验证账号密码是否对，不用可以忽略)
2. 获取用户的课程表

## 依赖项

- Flask
- asyncio
- aiohttp
- base64
- requests
- BeautifulSoup4
- ddddocr

## 安装

推荐使用 `pip` 安装所需的依赖项：

```bash
pip install flask asyncio aiohttp base64 requests beautifulsoup4 ddddocr
```

## 使用方法

启动服务：

```bash
python jw_kcb.py
```

服务运行在5000端口。

### 用户登录

向 `/login` 发送 POST 请求，包含 `loginid` 和 `password` 两个字段。

示例：

```bash
curl -X POST -H "Content-Type: application/json" -d '{"loginid":"your_login_id", "password":"your_password"}' http://localhost:5000/login
```

如果登录成功,将返回以下信息：

``````json
{"status": "success", "data": "JSESSIONID=4856EFAFA7F237007F573E00B349EDBE; SERVERID=121; JSESSIONID=5FDA7EE62F77B71501351CA5E59E10A5"}
``````

如果登录失败，将返回以下错误信息：

- `"用户名或密码错误"`：如果提供的用户名或密码错误

``````json
{"data": "用户名或密码错误", "status": "error"}
``````

- `"请重试"`：如果验证码错误五次，主要是防止死循环一半不会触发。

``````json
{"data": "请重试", "status": "error"}
``````

- `"未知错误"`：如果出现未预期的错误

``````json
{"data": "未知错误", "status": "error"}
``````

### 获取课程表

向 `/handle_kb` 发送 POST 请求，包含 `loginid` 和 `password` 两个字段。

示例：

```bash
curl -X POST -H "Content-Type: application/json" -d '{"loginid":"your_login_id", "password":"your_password"}' http://localhost:5000/handle_kb
```

如果获取成功,将返回以下信息：

```json
{"status": "success", "data": {"loginid": "2022233203335", "courses": [{"课程学分": "1.5", "课程属性": "选修", "课程名称": "脚本编程", "上课时间": ["08:30", "09:55"], "上课地点": "第四工业实训楼B309-310", "上课校区": "南海校区(北区)", "上课日期": "第2周 星期一 [01-02]节"}, {"课程学分": "4", "课程属性": "必修", "课程名称": "Java Web开发基础", "上课时间": ["08:30", "09:55"], "上课地点": "第四工业实训楼B209-210", "上课校区": "南海校区(北区)", "上课日期": "第2周 星期三 [01-02]节"}, {"课程学分": "1.5", "课程属性": "任选", "课程名称": "Linux系统应用", "上课时间": ["08:30", "09:55"], "上课地点": "第 四工业实训楼B301", "上课校区": "南海校区(北区)", "上课日期": "第2周 星期四 [01-02]节"}, {"课程学分": "3", "课程属性": " 选修", "课程名称": "数据结构", "上课时间": ["08:30", "09:55"], "上课地点": "第四工业实训楼B306", "上课校区": "南海校区( 北区)", "上课日期": "第2周 星期五 [01-02]节"}, {"课程学分": "4", "课程属性": "必修", "课程名称": "Java Web开发基础", "上课时间": ["10:15", "11:40"], "上课地点": "第四工业实训楼B209-210", "上课校区": "南海校区(北区)", "上课日期": "第2周 星期三 [03-04]节"}, {"课程学分": "1.5", "课程属性": "选修", "课程名称": "脚本编程", "上课时间": ["14:00", "15:25"], "上课地 点": "第四工业实训楼B309-310", "上课校区": "南海校区(北区)", "上课日期": "第2周 星期一 [07-08]节"}, {"课程学分": "2", " 课程属性": "必修", "课程名称": "毛泽东思想和中国特色社会主义理论体系概论", "上课时间": ["14:00", "15:25"], "上课地点": "1106", "上课校区": "南海校区(北区)", "上课日期": "第2周 星期三 [07-08]节"}, {"课程学分": "0.5", "课程属性": "必修", "课 程名称": "形势与政策（三）", "上课时间": ["14:00", "15:25"], "上课地点": "1002-1004", "上课校区": "南海校区(北区)", "上 课日期": "第2周 星期四 [07-08]节"}, {"课程学分": "3", "课程属性": "选修", "课程名称": "数据结构", "上课时间": ["14:00", "15:25"], "上课地点": "第四工业实训楼B306", "上课校区": "南海校区(北区)", "上课日期": "第2周 星期五 [07-08]节"}, {"课程 学分": "4", "课程属性": "必修", "课程名称": "Java Web开发基础", "上课时间": ["15:45", "17:10"], "上课地点": "第四工业实 训楼C509", "上课校区": "南海校区(北区)", "上课日期": "第2周 星期四 [09-10]节"}]}}
```

如果获取课程表失败，将返回以下错误信息：。

- `"用户名或密码错误"`：如果提供的用户名或密码错误

``````json
{"data": "用户名或密码错误", "status": "error"}
``````

- `"请重试"`：如果验证码错误五次，主要是防止死循环一半不会触发。

``````json
{"data": "请重试", "status": "error"}
``````

- `"未知错误"`：如果出现未预期的错误

``````json
{"data": "未知错误", "status": "error"}
``````

### 注意

- 该应用目前仅支持广东轻工职业技术学院教务系统。
- 请确保你在运行该应用之前已经正确安装了所有的依赖项。

## 贡献

欢迎任何形式的贡献，包括 bug 报告，新功能建议，代码贡献等。

## 许可

[MIT](https://github.com/your-github-account/your-repository/blob/main/LICENSE)